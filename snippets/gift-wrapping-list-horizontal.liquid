{%- doc -%}
  Renders a responsive horizontal list of gift wrapping items in the cart.

  Optimized for cart drawers and checkout with mobile design and accessibility features.

  @param {object} gift_items - Collection of gift wrapping line items from the cart
  @param {string} section_id - Section identifier for unique field IDs

  @example
  {% render 'gift-wrapping-list-horizontal', gift_items: items, section_id: section.id %}
{%- enddoc -%}

{%- if gift_items.size > 0 -%}
  <div class="cart__gift grid gap-4">
    <p class="font-medium text-lg">{{ 'cart.gift_wrapping.gift_wrapping_list' | t }}</p>
    <ul class="horizontal-products grid" role="list">
      {%- for item in gift_items -%}
        <li id="CartDrawer-Item-{{ item.key }}" class="horizontal-product flex items-center gap-4 md:gap-6" data-variant-id="{{ item.variant_id }}" data-handle="{{ item.product.handle }}" data-quantity="{{ item.quantity }}" data-price="{{ item.original_price }}">
          {%- if item.image -%}
            <a class="horizontal-product__media media media--{{ settings.product_image_ratio }}{% unless settings.product_image_fill %} media--contain{% endunless %} relative overflow-hidden shrink-0" href="{{ item.url }}" tabindex="-1">
              {{- item.image | image_url: width: item.image.width | image_tag: loading: 'lazy', widths: '180,360,540', is: 'lazy-image' -}}
            </a>
          {%- endif -%}
          <div class="horizontal-product__details grow flex flex-col justify-start gap-1d5">
            <div class="flex flex-col gap-1">
              <p class="horizontal-product__title font-medium text-base leading-tight">{{ item.product.title | escape }}</p>

              {%- if item.product.has_only_default_variant == false or item.properties.size != 0 or item.selling_plan_allocation != null -%}
                <dl class="grid gap-1d5">
                  {%- unless item.product.has_only_default_variant -%}
                    {%- for option in item.options_with_values -%}
                      <div class="text-xs text-opacity leading-tight">
                        <dt class="sr-only">{{ option.name }}:</dt>
                        <dd class="inline">{{ option.value }}</dd>
                      </div>
                    {%- endfor -%}
                  {%- endunless -%}

                  {%- for property in item.properties -%}
                    {%- assign property_first_char = property.first | slice: 0 -%}
                    {%- if property.last != blank and property_first_char != '_' -%}
                      <div class="text-xs text-opacity leading-tight">
                        <dt class="inline">{{ property.first }}:&nbsp;</dt>
                        <dd class="inline">
                          {%- if property.last contains '/uploads/' -%}
                            <a href="{{ property.last }}" class="link" target="_blank" aria-describedby="a11y-new-window-message">
                              {{- property.last | split: '/' | last -}}
                            </a>
                          {%- else -%}
                            {{- property.last -}}
                          {%- endif -%}
                        </dd>
                      </div>
                    {%- endif -%}
                  {%- endfor -%}
                </dl>

                {%- if item.selling_plan_allocation != null -%}
                  <p class="text-xs text-opacity">{{ item.selling_plan_allocation.selling_plan.name }}</p>
                {%- endif -%}
              {%- endif -%}
            </div>
            <div class="flex flex-col gap-1">
              <div class="price{% if item.original_price != item.final_price %} price--on-sale{% endif %} text-sm flex flex-wrap gap-1d5">
                {%- liquid
                  assign money_price = item.original_price | money
                  if settings.currency_code_enabled
                    assign money_price = item.original_price | money_with_currency
                  endif
                -%}
                {%- if item.original_price != item.final_price -%}
                  <span class="sr-only">{{ 'products.price.regular_price' | t }}</span>
                  <span class="price__sale inline-flex items-center relative">{{ money_price }}</span>
                  <span class="sr-only">{{ 'products.price.sale_price' | t }}</span>
                  <span class="price__regular whitespace-nowrap">
                    {%- liquid
                      if settings.currency_code_enabled
                        echo item.final_price | money_with_currency
                      else
                        echo item.final_price | money
                      endif
                    -%}
                  </span>
                {%- else -%}
                  {{- money_price -}}
                {%- endif -%}

                {%- if item.variant.available and item.unit_price_measurement -%}
                  <span class="sr-only">{{ 'products.price.unit_price' | t }}</span>
                  <span class="unit-price flex items-center">
                    {%- liquid
                      capture unit_price_base_unit
                        if item.variant.unit_price_measurement
                          if item.variant.unit_price_measurement.reference_value != 1
                            echo item.variant.unit_price_measurement.reference_value
                          endif
                          echo item.variant.unit_price_measurement.reference_unit
                        endif
                      endcapture
                    -%}
                    ({{ item.variant.unit_price | money }}
                    <span aria-hidden="true">/</span>
                    <span class="sr-only">&nbsp;{{ 'general.accessibility.unit_price_separator' | t }}&nbsp;</span>
                    {{ unit_price_base_unit }})
                  </span>
                {%- endif -%}
              </div>

              {%- if item.line_level_discount_allocations != blank -%}
                <ul class="discounts grid gap-2" role="list" aria-label="{{ 'customer.order.discounts' | t | escape }}">
                  {%- for discount_allocation in item.line_level_discount_allocations -%}
                    <li class="discounts__discount text-xs flex flex-wrap items-center gap-1">
                      <span class="badge badge--highlight flex items-center gap-1d5 font-medium leading-none">{{ discount_allocation.discount_application.title }}</span>
                      <span class="badge badge--onsale flex items-center gap-1d5 font-medium leading-none">-{{ discount_allocation.amount | money }}</span>
                    </li>
                  {%- endfor -%}
                </ul>
              {%- endif -%}
            </div>
          </div>

          <gift-wrap-item class="horizontal-product__quantity align-self-stretch shrink-0 text-sm sm:block" data-section-id="{{ section_id }}">
            <script type="application/json" data-gift-item>{{ item | json }}</script>
            {%- if item.parent_relationship -%}
              <script type="application/json" data-line-item>{{ item.parent_relationship.parent | json }}</script>
            {%- endif -%}
            <div class="flex flex-col justify-between gap-3 h-full">
              <div class="cart-quantity flex items-center relative">
                <label class="sr-only" for="Quantity-{{ section_id }}-{{ item.key }}">
                  {{- 'products.quantity.label' | t -}}
                </label>
                <input class="quantity__input input text-center w-full h-full"
                  type="number"
                  name="updates[]"
                  aria-label="{{ 'products.quantity.input_label' | t: product: item.product.title | escape }}"
                  id="Quantity-{{ section_id }}-{{ item.key }}"
                  inputmode="numeric"
                  autocomplete="off"
                  data-quantity-variant-id="{{ item.variant.id }}"
                  data-cart-quantity="{{ cart | item_count_for_variant: item.variant.id }}"
                  min="0"
                  data-min="{{ item.variant.quantity_rule.min }}"
                  {% if item.variant.quantity_rule.max != null %}
                    max="{{ item.variant.quantity_rule.max }}"
                  {% endif %}
                  step="{{ item.variant.quantity_rule.increment }}"
                  value="{{ item.quantity }}"
                  disabled
                />
              </div>
              <div class="text-xs text-right relative">
                <div id="Loader-{{ section_id }}-{{ item.key }}" class="loader absolute right-0" hidden>
                  {%- render 'icon', icon: 'rotator', size: 'xs', class: 'animate-rotator' -%}
                </div>
                <a class="link" href="{{ item.url_to_remove }}" is="unset-gift-wrap" data-index="{{ item.key }}" data-no-instant>{{ 'cart.general.remove' | t }}</a>
              </div>
            </div>
          </gift-wrap-item>
        </li>
      {%- endfor -%}
    </ul>
  </div>
{%- endif -%}
